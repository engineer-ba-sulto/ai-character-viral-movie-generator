# 機能仕様書: AI キャラクターアニメーション React プロジェクトの移行

**機能ブランチ**: `001-ai-character-animation`
**作成日**: 2025-10-07
**ステータス**: ドラフト
**入力**: ユーザー記述: "@ai-character-animation-react のプロジェクトを今のプロジェクトに移行したい"

## 実行フロー (main)

```
1. 入力からユーザー記述を解析
   → 空の場合: エラー "機能記述が提供されていません"
2. 記述から主要な概念を抽出
   → 識別: 関係者、アクション、データ、制約
3. 不明瞭な点について
   → [要明確化: 具体的な質問] でマーク
4. ユーザーシナリオとテストのセクションを記入
   → 明確なユーザーフローがない場合: エラー "ユーザーシナリオを決定できません"
5. 機能要件を生成
   → 各要件はテスト可能でなければならない
   → 曖昧な要件をマーク
6. 主要エンティティを識別 (データが関与する場合)
7. レビューチェックリストを実行
   → [要明確化] がある場合: 警告 "仕様書には不確定要素があります"
   → 実装詳細が見つかった場合: エラー "技術的な詳細を削除してください"
8. 戻り値: 成功 (仕様書は計画段階の準備完了)
```

---

## ⚡ クイックガイドライン

- ✅ ユーザーが **何を** 必要とし、**なぜ** それを必要とするかに焦点を当てる
- ❌ **どのように** 実装するかは避ける (技術スタック、API、コード構造など)
- 👥 開発者ではなく、ビジネス関係者向けに記述する

### セクション要件

- **必須セクション**: すべての機能で完了する必要がある
- **任意セクション**: 機能に関連する場合にのみ含める
- セクションが適用されない場合は、完全に削除する ("N/A" として残さない)

### AI 生成用

ユーザープロンプトからこの仕様書を作成する場合:

1. **すべての曖昧さをマークする**: 仮定を立てる必要がある場合は、[要明確化: 具体的な質問] を使用する
2. **推測しない**: プロンプトで指定されていない場合 (例: 認証方法のない「ログインシステム」)、マークを付ける
3. **テスターのように考える**: すべての曖昧な要件は、「テスト可能で曖昧さがない」というチェックリスト項目で失敗するべき
4. **一般的に不十分に指定されがちな領域**:
   - ユーザータイプと権限
   - データ保持/削除ポリシー
   - パフォーマンス目標と規模
   - エラー処理の動作
   - 統合要件
   - セキュリティ/コンプライアンスのニーズ

---

## ユーザーシナリオとテスト _(必須)_

### 主要なユーザーストーリー

開発者として、既存の `ai-character-animation-react` プロジェクトを現在の Next.js プロジェクト構造に移行し、コードベースを統一し、開発を効率化し、Next.js フレームワークの機能（サーバーサイドレンダリングや API ルートなど）を活用したい。

### 受け入れシナリオ

1. **前提**: `ai-character-animation-react` プロジェクトが別の Vite アプリケーションとして存在する。 **実行**: 移行が完了したとき。 **結果**: すべてのコンポーネント、サービス、アセットがメインの Next.js プロジェクトの `src/` ディレクトリに統合されていること。
2. **前提**: 古いプロジェクトの UI コンポーネントが移行されている。 **実行**: Next.js 開発サーバーを実行したとき。 **結果**: Next.js アプリケーション内のページでキャラクターアニメーション UI を表示し、操作でき、そのデザインは元のアプリケーションと完全に一致すること。
3. **前提**: ビジネスロジック（例: `geminiService.ts`）が移行されている。 **実行**: UI を操作したとき。 **結果**: 基盤となるサービスを正しく呼び出し、元のアプリケーションと同じように機能すること。

### エッジケース

- 2 つのプロジェクト間で競合する依存関係はどのように処理されるか？ → **解決済み:** 主な依存関係は `@google/genai` のみで、大きな競合はない見込み。移行時に `package.json` にマージする。
- 統一されたプロジェクトで環境変数はどのようにマージおよび管理されるか？ → **解決済み:** `geminiService.ts` で使用されている API キーなどの環境変数は、Next.js プロジェクトの `.env.local` に移行する。
- Vite アプリが React Router のようなルーターを使用していた場合、ルーティングを移行する計画は？ → **解決済み:** ルーティングライブラリは使用されていない。Next.js の App Router で新しい単一ページ(`/character-animation`)を作成し、そこにコンポーネントを配置する。

## 要件 _(必須)_

### 機能要件

- **FR-001**: システムは、`ai-character-animation-react/components` からすべての React コンポーネントを `src/components/` に移動しなければならない。
- **FR-002**: システムは、`geminiService.ts` のようなすべてのサービスを `src/utils/` に移動しなければならない。
- **FR-003**: システムは、すべての静的アセット（アイコン、画像）を `public/` ディレクトリに移動し、すべてのインポートパスを更新しなければならない。
- **FR-004**: システムは、移行されたアプリケーションのメインコンポーネントをレンダリングするために、Next.js の `app` ルーターに新しいページルート（例: `/character-animation`）を作成しなければならない。
- **FR-005**: システムは、`ai-character-animation-react/package.json` からの依存関係をルートの `package.json` にマージし、バージョンの競合を解決しなければならない。
- **FR-006**: システムは、すべてのコンポーネントスタイル（Tailwind CSS を想定）が Next.js アプリケーション内で正しく適用およびレンダリングされることを保証しなければならない。
- **FR-007**: システムは、古いプロジェクトの環境変数を Next.js の環境変数システム（`.env.local`）に設定しなければならない。
- **FR-008**: システムは、移行後の UI が元の `ai-character-animation-react` アプリケーションの UI とピクセルパーフェクトで一致することを保証しなければならない。

### 主要エンティティ _(データが関与する場合に含める)_

- **キャラクター**: 生成されたキャラクターを表し、その画像、プロパティ、設定を含む。
- **シーン**: ビデオを作成するためのキャラクターと背景要素のコレクション。
- **ビデオ**: 最終的にレンダリングされたアニメーション出力。

---

## レビューと受け入れのチェックリスト

_GATE: main() 実行中に自動チェックが実行される_

### コンテンツの品質

- [x] 実装の詳細（言語、フレームワーク、API）がない
- [x] ユーザー価値とビジネスニーズに焦点が当てられている
- [x] 技術者でない関係者向けに書かれている
- [x] すべての必須セクションが完了している

### 要件の完全性

- [x] [要明確化] のマーカーが残っていない
- [x] 要件はテスト可能で曖昧さがない
- [x] 成功基準は測定可能である
- [x] スコープが明確に区切られている
- [ ] 依存関係と仮定が特定されている

---

## 実行ステータス

_main() による処理中に更新_

- [x] ユーザー記述が解析された
- [x] 主要な概念が抽出された
- [ ] 曖昧さがマークされた
- [x] ユーザーシナリオが定義された
- [x] 要件が生成された
- [x] エンティティが特定された
- [ ] レビューチェックリストに合格した

---
